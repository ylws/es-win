"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),CFCMWin=function(){function e(t,i){_classCallCheck(this,e),this.initVal(t,i)}return _createClass(e,[{key:"initVal",value:function(e,t){this.fatherid=t;var i={width:"420px",height:"180px",type:"txt",typehtmlfn:!1,typemargin:"0px",typepadding:"0px",typeval:"",typewid:"100%",typehei:"32px",title:"标题",iframeid:"",iframeclass:"iframe",iframefullscreen:!1,scroll:"no",templates:!1,iframesubfn:"init",iframescrollLock:!1,placeholder:"",position:"auto",positionx:"auto",positiony:"auto",content:"",closeshow:!0,btnshow:"block",btn:[[".cancel","取消","0px"],[".save","保存"]],headshow:"block",winclose:function(){},save:function(){},cancel:function(){},timeout:0,bodyMinWid:1200,titleEvent:{event:!0,type:"pc"},resize:!0};this.cfg={},_extends(this.cfg,i,e),this.cfg.winlen=0,this.initCommonVal(),this.appendhtml()}},{key:"initCommonVal",value:function(){var e=this.cfg;e.seeheight=window.innerHeight,e.seewidth=window.innerWidth,e.allhei=document.body.scrollHeight,e.allwid=document.body.scrollWidth,e.bodyhei=parseInt(document.body.clientHeight),e.scrolltopval=document.body.scrollTop||document.documentElement.scrollTop,e.scrollleftval=document.body.scrollLeft||document.documentElement.scrollLeft,e.heights=e.scrolltopval+e.seeheight/2-parseInt(e.height)/2+"px"}},{key:"getId",value:function(e){return document.getElementById(e)}},{key:"getIdClass",value:function(e,t){return document.getElementById(e).querySelector("."+t)}},{key:"appendhtml",value:function(){var e=this,t=this.cfg;0!=t.winlen&&(t.winlen=document.querySelectorAll(".win").length);var i=document.createElement("div");if("tips"==t.type){i.setAttribute("class","tips tips"+t.typeval.val),i.setAttribute("id","tips"+t.winlen);var n="",o=void 0,l=void 0,s=void 0,a=void 0,r=void 0;switch(s=this.getId(t.typeval.id),o=s.offsetLeft,l=s.offsetTop,a=s.clientWidth,r=s.clientHeight,t.typeval.val){case"left":n="left:"+(o-parseInt(t.width)-20)+"px;top:"+l+"px;width:"+t.width+";height:"+t.height+";line-height:"+t.height+";position:absolute;";break;case"top":n="left:"+(o-parseInt(t.width)/2)+"px;top:"+(l-r-20)+"px;width:"+t.width+";height:"+t.height+";line-height:"+t.height+";position:absolute;";break;case"bottom":n="left:"+(o-parseInt(t.width)/2)+"px;top:"+(l+r+20)+"px;width:"+t.width+";height:"+t.height+";line-height:"+t.height+";position:absolute;";break;default:n="left:"+(o+20+a)+"px;top:"+l+"px;width:"+t.width+";height:"+t.height+";line-height:"+t.height+";position:absolute;"}return i.setAttribute("style",n),i.innerHTML=t.content,document.body.appendChild(i),void setTimeout(function(){if(e.browser().ie9)return e.remove(e.getId("tips"+e.cfg.winlen)),void("function"==typeof e.cfg.timefn&&e.cfg.timefn());i.style.animationName="reversewinanimation",i.addEventListener("animationend",function(){i.style.opacity=0,e.remove(e.getId("tips"+e.cfg.winlen)),"function"==typeof e.cfg.timefn&&e.cfg.timefn()},!1)},t.timeout?t.timeout:3e3)}i.setAttribute("class","win"),i.setAttribute("id","win"+t.winlen),i.innerHTML=function(e){var t=e.cfg;"tips"==t.type&&(t.headshow="none",t.closeshow=!1);var i="";return"auto"==t.position?i+='<div class="win_content" style="height:'+t.height+";width:"+t.width+';margin:auto;">':i+='<div class="win_content" style="height: '+t.height+";width:"+t.width+";left:"+("auto"==t.positionx?t.seewidth/2-parseInt(t.width)/2:t.positionx)+"px;top:"+("auto"==t.positiony?t.heights:t.positiony)+'">',i+='<div class="title" style="display:'+t.headshow+'">',i+='<span class="menuname">'+t.title+"</span>",i+="</div>",i+='<div class="winclose iconfont icon-guanbijiantou" style="display:'+(t.closeshow?"block":"none")+'"></div>',"txt"==t.type?i+='<div class="txt">'+t.content+"</div>":"input"==t.type?i+='<input type="text" value="'+t.typeval+'" class="input" placeholder="'+t.placehloder+'" style="margin:'+t.typemargin+";padding:"+t.typepadding+";width:"+t.typewid+";height:"+t.typehei+'"/>':"iframe"==t.type?""!=t.iframeid?i+='<iframe allowfullscreen="'+t.iframefullscreen+'"  name="iframe'+t.winlen+'"  scrolling="'+t.scroll+'" frameborder="0" src="'+t.typeval+'" class="'+t.iframeclass+'" style="margin:'+t.typemargin+";padding:"+t.typepadding+";width:"+t.typewid+";height:"+t.typehei+'" id="'+t.iframeid+'" ></iframe>':i+='<iframe allowfullscreen="'+t.iframefullscreen+'"  name="iframe'+t.winlen+'"  scrolling="'+t.scroll+'" frameborder="0" src="'+t.typeval+'" class="'+t.iframeclass+'" style="margin:'+t.typemargin+";padding:"+t.typepadding+";width:"+t.typewid+";height:"+t.typehei+'"></iframe>':i+='<div class="content">'+t.content+"</div>",i+='<div class="btnline"  style="display:'+t.btnshow+'">',Array.prototype.slice.call(t.btn).forEach(function(e,n){void 0!=t.btn[n][2]?i+='<div class="'+t.btn[n][0].substring(1)+'" style="margin-left:'+t.btn[n][2]+'">'+t.btn[n][1]+"</div>":i+='<div class="'+t.btn[n][0].substring(1)+'" >'+t.btn[n][1]+"</div>"}),i+="</div>",i+="</div>"}(this),document.body.appendChild(i),this.getId("win"+t.winlen).style.opacity="1","iframe"==t.type&&(window.frames["iframe"+t.winlen].onload=function(){e.cfg.templates?window.frames["iframe"+e.cfg.winlen][e.cfg.iframesubfn](e.cfg.templates):window.frames["iframe"+e.cfg.winlen][e.cfg.iframesubfn]()}),this.appendhtmlexe(),this.resize(),this.winfor(),this.winmove()}},{key:"remove",value:function(e){var t=e.parentNode;t&&t.removeChild(e)}},{key:"resize",value:function(){var e=this.cfg;if(e.resize){var t=this,i=null;window.addEventListener("resize",function(){i&&clearTimeout(i),i=setTimeout(function(){var i=document.querySelectorAll(".win");e.winlen=i.length,i&&(Array.prototype.slice.call(i).forEach(function(e){e.style.height=0,e.querySelector(".win_content").style.margin="auto"}),t.initCommonVal(),e.seewidth<e.bodyMinWid?Array.prototype.slice.call(i).forEach(function(t){t.style.width=e.bodyMinWid;var i=t.querySelector(".win_content");"auto"!=e.position?i.style.left=this.cfg.seewidth/2-parseInt(e.width)/2+"px":i.style.left=0}):Array.prototype.slice.call(i).forEach(function(t){t.style.width="100%";var i=t.querySelector(".win_content");"auto"!=e.position?i.style.left=this.cfg.seewidth/2-parseInt(e.width)/2+"px":i.style.left=0}),e.allhei>=e.bodyhei&&Array.prototype.slice.call(i).forEach(function(t){t.style.height=e.allhei+"px";var i=t.querySelector(".win_content");"auto"==e.position?i.style.top=0:i.style.top=e.seeheight/2+e.scrolltopval-e.height/2+"px"}))},200)})}}},{key:"appendhtmlexe",value:function(){var e=this,t=this.cfg;if("function"==typeof this.cfg.typehtmlfn&&this.cfg.typehtmlfn(),0!=this.cfg.timeout){this.cfg.btnshow="none";var i="win"+t.winlen;this.getIdClass(i,"btnline").style.display="none";var n={id:i,remove:this.remove,getid:this.getId(i)};setTimeout(function(){e.browser().ie9?"function"==typeof t.timefn?(e.remove(n.getid),t.timefn(t.fatherid)):e.remove(n.getid):(n.getid.style.animationName="reversewinanimation",n.getid.addEventListener("animationend",function(){n.getid.style.opacity=0,"function"==typeof t.timefn?(e.remove(n.getid),t.timefn(t.fatherid)):e.remove(n.getid)},!1))},t.timeout)}this.iframescrollLock&&(document.body.onmousewheel=function(){return!1})}},{key:"browser",value:function(){return{ie9:null!=navigator.userAgent.match(/.(msie)[\/: ]([9.]+)/i)}}},{key:"winfn",value:function(e,t){var i=this,n=this.cfg,o=t.substring(1);e.querySelector(t)&&e.querySelector(t).addEventListener("click",function(){var e=null,t={id:e="winclose"==o?this.parentNode.parentNode.getAttribute("id"):this.parentNode.parentNode.parentNode.getAttribute("id"),remove:i.remove,getid:i.getId(e)};i.browser().ie9?"function"==typeof n[o]&&(n[o](t),"winclose"==o&&i.remove(t.getid)):(t.getid.style.animationName="reversewinanimation",t.getid.addEventListener("animationend",function(){t.getid.style.opacity=0,"function"==typeof n[o]&&(n[o](t),"winclose"==o&&i.remove(t.getid))},!1),n.iframescrollLock&&(document.body.onmousewheel=null))},!1)}},{key:"winfor",value:function(){var e=document.querySelectorAll(".win"),t=this;Array.prototype.slice.call(e).forEach(function(e,i){t.winfn(e,".winclose");for(var n=0;n<t.cfg.btn.length;n++)t.winfn(e,t.cfg.btn[n][0])})}},{key:"getStyle",value:function(e,t){return window.getComputedStyle?window.getComputedStyle(e,null)[t]:e.currentStyle[t]}},{key:"getoffset",value:function(e,t){if(null==e)return t;t||((t={}).top=0,t.left=0);var i=this.getStyle(e,"position");if("absolute"==i||"relative"==i){if(e.getBoundingClientRect&&null!=navigator.userAgent.toLowerCase().match(/.(msie)/))return t.top+=e.getBoundingClientRect.top,t.left+=e.getBoundingClientRect.left,t;t.top+=e.offsetTop,t.left+=e.offsetLeft}else t.top+=0,t.left+=0;return this.getoffset(e.parentElement,t)}},{key:"winmove",value:function(){var e=this.cfg;if(e.titleEvent.event){var t=this;e.scrollwid=e.seewidth-document.documentElement.clientWidth,e.scrollhei=e.seeheight-document.documentElement.clientHeight,e.titlemoveflag=!1,"pc"==e.titleEvent.type?(this.getIdClass("win"+e.winlen,"title").onmousedown=function(i){document.onselectstart=function(){return!1};var n=this,o=window.event||i,l=o.pageX||o.clientX,s=o.pageY||o.clientY,a=t.getoffset(this).left,r=t.getoffset(this).top,c=parseInt(n.parentNode.clientWidth),d=parseInt(n.parentNode.clientHeight);e.titlemoveflag=!0,e.titlemoveflag&&(document.onmousemove=function(t){var i=window.event||t,o=i.pageX||i.clientX,f=(i.pageY||i.clientY)-s,h=a+(o-l)+e.scrollleftval,u=r+f+e.scrolltopval;c+h>=e.seewidth-e.scrollwid&&(h=e.seewidth-c-e.scrollwid),h<=0&&(h=0),d+u>=e.allhei&&(u=e.allhei-d),u<=0&&(u=0);var p=n.parentNode.style;p.left=h+"px",p.top=u+"px",p.margin=0})},document.onmouseup=function(){e.titlemoveflag=!1,document.onmousemove=null,document.onselectstart=null}):this.getIdClass("win"+e.winlen,"title").addEventListener("touchstart",function(i){document.onselectstart=function(){return!1};var n=this,o=(window.event||i).touches[0],l=Number(o.pageX),s=Number(o.pageY),a=t.getoffset(this).left,r=t.getoffset(this).top,c=parseInt(n.parentNode.clientWidth),d=parseInt(n.parentNode.clientHeight);if(e.titlemoveflag=!0,e.titlemoveflag)var f=document.addEventListener("touchmove",function(t){var i=(window.event||t).touches[0],o=Number(i.pageX),f=Number(i.pageY),h=a+(o-l),u=r+(f-s);c+h>=e.seewidth&&(h=e.seewidth-c),h<=0&&(h=0),d+u>=e.allhei&&(u=e.allhei-d),u<=0&&(u=0);var p=n.parentNode.style;p.left=h+"px",p.top=u+"px",p.margin=0});document.ontouchend=function(){e.titlemoveflag=!1,document.removeEventListener(f),document.onselectstart=null}},!1)}}}]),e}();
export function CFCMWin(param) {
		return new CFCMWin(param)
	}